<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="layui/css/layui.css" rel="stylesheet">
    <script src="js/jquery.min.js"></script>
    <script src="js/axios.min.js"></script>
    <script src="layui/layui.js"></script>
</head>
<body>
<div class="layui-row" style="background-color: #ffffff; display: flex; align-items: center; height: 60px">
    <div class="layui-col-md1" id="title">
        储能演示
    </div>
    <div class="layui-col-md10" style="padding-left: 100px;">
        <ul>
            <li class="layui-btn layui-btn-primary layui-btn-radius page-button" style="background-color: #e2e2e2"
                ><a href="/index.html">首页</a></li>
            <li class="layui-btn layui-btn-primary layui-btn-radius page-button" style="background-color: #e2e2e2"
                ><a href="/pcs.html">PCS</a></li>
            <li class="layui-btn layui-btn-primary layui-btn-radius page-button" style="background-color: #e2e2e2"
                ><a href="/bms.html">BMS</a></li>
            <li class="layui-btn layui-btn-primary layui-btn-radius page-button" style="background-color: #e2e2e2"
                ><a href="">收益</a></li>
            <li class="layui-btn layui-btn-primary layui-btn-radius page-button" style="background-color: #e2e2e2"
                ><a href="">一次图</a></li>
            <li class="layui-btn layui-btn-primary layui-btn-radius page-button" style="background-color: #e2e2e2"
                ><a href="">定值设置</a></li>
            <li class="layui-btn layui-btn-primary layui-btn-radius page-button" style="background-color: #e2e2e2"
                ><a href="backManage.html">后台管理</a></li>
            <li class="layui-btn layui-btn-primary  layui-btn-danger" style="float: right" id="logout"><a
                    href="">登出</a></li>
            <li class="layui-btn layui-btn-primary" style="float: right" id="change-sub">
                <span>切换储能站</span>
                <i class="layui-icon layui-icon-down layui-font-12"></i>
            </li>

        </ul>
    </div>
    <div class="layui-col-md1" style="text-align: center; color: #666666">
        <div id="current-day"></div>
        <div id="current-time"></div>
    </div>
</div>
<div class="layui-row" style="padding: 20px">
    <div class="layui-col-md6">
        <div id="sub-running-status">
            <div style="margin-bottom: 10px;">
                <span class="part-title">储能站运行情况</span>
                <span style="float: right" id="running-days"></span>
            </div>

            <div class="layui-row">
                <div class="layui-col-md4" style="display: flex">
                    <div style="display: inline-block">
                        <img src="icon/趋势_trend.png" width="40px" height="40px">
                    </div>
                    <div class="running-details">
                        今日充电量
                        <div id="todayChCap"></div>
                    </div>

                </div>
                <div class="layui-col-md4" style="display: flex">
                    <div style="display: inline-block">
                        <img src="icon/趋势_trend%20(2).png" width="40px" height="40px">
                    </div>
                    <div class="running-details">
                        今日放电量
                        <div id="todayDiCap"></div>
                    </div>
                </div>
                <div class="layui-col-md4" style="display: flex">
                    <div style="display: inline-block">
                        <img src="icon/电池充电_battery-charge.png" width="40px" height="40px">
                    </div>
                    <div class="running-details">
                        电站状态
                        <div id="subStatus"></div>
                    </div>

                </div>
            </div>
            <div class="layui-row">
                <div class="layui-col-md4">
                    <div style="display: inline-block">
                        <img src="icon/电池充电_battery-charge%20(1).png" width="40px" height="40px">
                    </div>
                    <div class="running-details">
                        累计充电量
                        <div id="accumulatedChCap"></div>
                    </div>

                </div>
                <div class="layui-col-md4">
                    <div style="display: inline-block">
                        <img src="icon/电池运行_battery-working.png" width="40px" height="40px">
                    </div>
                    <div class="running-details">
                        累计放电量
                        <div id="accumulatedDiCap"></div>
                    </div>
                </div>
                <div class="layui-col-md4" style="height: 100%">
                    <div style="display: inline-block">
                        <img src="icon/闪光模式_flashlamp.png" width="40px" height="40px">
                    </div>
                    <div class="running-details">
                        SOC<span style="visibility: hidden">文字</span>
                        <div id="soc"></div>
                    </div>

                </div>
            </div>
            <div class="layui-row">
                <div class="layui-col-md4">
                    <div style="display: inline-block">
                        <img src="icon/脑电图_eeg.png" width="40px" height="40px">
                    </div>
                    <div class="running-details">
                        实时有功
                        <div id="realTimeActivePower"></div>
                    </div>

                </div>
                <div class="layui-col-md4">
                    <div style="display: inline-block">
                        <img src="icon/脑电图_eeg.png" width="40px" height="40px">
                    </div>
                    <div class="running-details">
                        实时无功
                        <div id="realTimeReactivePower"></div>
                    </div>
                </div>
                <div class="layui-col-md4">
                    <div style="display: inline-block">
                        <img src="icon/电池_battery-working-one.png" width="40px" height="40px">
                    </div>
                    <div class="running-details">
                        可充电量
                        <div id="ableEnergyChCap"></div>
                    </div>

                </div>
            </div>
            <div class="layui-row">
                <div class="layui-col-md4">
                    <div style="display: inline-block">
                        <img src="icon/速度_speed-one.png" width="40px" height="40px">
                    </div>
                    <div class="running-details">
                        今日充放电次数
                        <div id="todayChDiTimes"></div>
                    </div>

                </div>
                <div class="layui-col-md4">
                    <div style="display: inline-block">
                        <img src="icon/速度_speed-one.png" width="40px" height="40px">
                    </div>
                    <div class="running-details">
                        本月充放电次数
                        <div id="monthChDiTimes"></div>
                    </div>
                </div>
                <div class="layui-col-md4">
                    <div style="display: inline-block">
                        <img src="icon/电池_battery-working-one.png" width="40px" height="40px">
                    </div>
                    <div class="running-details">
                        可放电量
                        <div id="ableEnergyDiCap"></div>
                    </div>

                </div>
            </div>
        </div>
        <div id="income">
            <div class="part-title">经济收益</div>
            <div class="income-type" style="background-color: #7a8aff; ">
                <div style="text-align: left">累计收益</div>
                <div id="accumulated-income">11</div>
            </div>
            <div class="income-type" style="background-color: #678bcc;">
                <div style="text-align: left">今日收益</div>
                <div id="today-income">11</div>
            </div>
            <div class="income-type" id="last-type" style="background-color: #678bcc;">
                <div style="text-align: left">昨日收益</div>
                <div id="lastDay-income">11</div>
            </div>
            <div class="layui-row" style="display: flex; background-color: #f6f8fb; margin-top: 10px;">
                <div class="income-detail">
                    <div>日均（元）</div>
                    <div id="day-average"></div>
                </div>
                <div class="income-detail">
                    <div>当月（元）</div>
                    <div id="this-month"></div>
                </div>
                <div class="income-detail">
                    <div>月均（元）</div>
                    <div id="month-average"></div>
                </div>
                <div class="income-detail">
                    <div>年度（元）</div>
                    <div id="this-year"></div>
                </div>
                <div class="income-detail">
                    <div>年均（元）</div>
                    <div id="year-average"></div>
                </div>
            </div>
            <div class="layui-btn-container" style="float: right; display: flex; align-items: center">
                <button class="layui-btn layui-btn-sm layui-btn-primary is-choose"
                        id="change-month-chart">月曲线
                </button>
                <button class="layui-btn layui-btn-sm layui-btn-primary layui-border-blue"
                        id="change-year-chart">年曲线
                </button>
            </div>
            <div id="income-chart" style="width: 98%; height: 250px; float: right"></div>
        </div>
    </div>
    <div class="layui-col-md6" style="padding-left: 15px">
        <div id="evaluation-analysis">
            <div class="part-title">评价分析</div>
            <div class="layui-row layui-col-space10" style="display: flex">
                <div class="layui-col-md2">
                    <div class="evaluation-analysis-part">
                        综合效率
                        <div id="comprehensiveEfficiency" class="evaluation-analysis-data"></div>
                    </div>
                </div>
                <div class="layui-col-md2">
                    <div class="evaluation-analysis-part">
                        运行系数
                        <div id="runningFactor" class="evaluation-analysis-data"></div>
                    </div>
                </div>
                <div class="layui-col-md2" \>
                    <div class="evaluation-analysis-part">
                        利用率指数
                        <div id="utilizationRate" class="evaluation-analysis-data"></div>
                    </div>
                </div>
                <div class="layui-col-md2">
                    <div class="evaluation-analysis-part">
                        储能损耗率
                        <div id="lossRate" class="evaluation-analysis-data"></div>

                    </div>
                </div>
                <div class="layui-col-md2">
                    <div class="evaluation-analysis-part">
                        利用系数
                        <div id="utilizationFactor" class="evaluation-analysis-data"></div>

                    </div>
                </div>
                <div class="layui-col-md2">
                    <div class="evaluation-analysis-part">
                        等效充放电次数
                        <div id="equivalentChDiTimes" class="evaluation-analysis-data"></div>

                    </div>
                </div>
            </div>
        </div>
        <div id="equipment-status">
            <div class="part-title">设备状态</div>
            <div class="layui-row layui-col-space10">
                <div class="layui-col-md3">
                    <div id="bms-status"></div>
                    <div class="equipment-counts">11</div>
                    <div class="alarm-counts">22</div>
                </div>
                <div class="layui-col-md3">
                    <div id="pcs-status"></div>
                    <div class="equipment-counts">11</div>
                    <div class="alarm-counts">22</div>
                </div>
                <div class="layui-col-md3">
                    <div id="air-conditioner-status"></div>
                    <div class="equipment-counts">11</div>
                    <div class="alarm-counts">22</div>
                </div>
                <div class="layui-col-md3">
                    <div id="fire-control-status"></div>
                    <div class="equipment-counts">11</div>
                    <div class="alarm-counts">22</div>
                </div>
            </div>
        </div>
        <div id="real-time-data">
            <div style="margin-left: 15px; font-weight: bold;">实时数据</div>
            <div id="real-time-data-chart"></div>
        </div>
    </div>

</div>
<script>
    layui.config({
        version: 2,
        base: 'echarts/'
    }).use(['form', 'echarts', 'dropdown'], function () {
        var form = layui.form;
        var dropdown = layui.dropdown;
        echarts = layui.echarts;
        var $ = layui.$;


        var stamp = new Date().getTime() + 8 * 60 * 60 * 1000;
        var currentDay = new Date(stamp).toISOString().replace(/T/, ' ').substring(0, 10);
        var currentTime = new Date(stamp).toISOString().replace(/\..+/, '').substring(11, 19);

        $('#current-day').html(currentDay);
        $('#current-time').html(currentTime);

        var runningDays = 0;
        var todayChCap = 0;
        var todayDiCap = 0;
        var subStatus = true ? "正常" : "故障";
        var accumulatedChCap = 0;
        var accumulatedDiCap = 0;
        var soc = 0;
        var realTimeActivePower = 0;
        var realTimeReactivePower = 0;
        var ableEnergyChCap = 0;
        var todayChDiTimes = 0;
        var monthChDiTimes = 0;
        var ableEnergyDiCap = 0;
        var accumulatedIncome = 0;
        var todayIncome = 0;
        var lastDayIncome = 0;
        var comprehensiveEfficiency = 0;
        var runningFactor = 0;
        var utilizationRate = 0;
        var lostRate = 0;
        var utilizationFactor = 0;
        var equivalentChDiTimes = 0;
        // 存放储能站数据
        var subData = [];
        var subCounts = 0;
        var dropdownArr = [];

        const token = localStorage.getItem('Authorization');
        axios.get('/substation/runningStatus', {
            headers: {
                'Authorization': `Bearer ${token}`
            }
        })
            .then(function (response) {
                if (response.data.code === 500 ) {
                    console.log("跳转")
                    window.location.href = "login.html";
                }
                console.log(response.data)
                console.log(response.data.message);
                console.log(response.code)
                console.log(response.data.data)
                subData = response.data;
                subCounts = subData.length;
                if (subCounts >= 1) {
                    for (var i = 1; i <= subCounts; i++) {
                        dropdownArr.push({title: "储能站" + i, id: i - 1});
                    }
                }
                if (subCounts === 1) {
                    console.log("隐藏")
                    $('#change-sub').hide();
                } else {
                    $('#change-sub').show();
                }
                console.log(subData[0])
                if (subData.length != 0) {
                    runningDays = subData[0].accumulatedRunningTime;
                    todayChCap = subData[0].charCapDay;
                    todayDiCap = subData[0].discCapDay;
                    subStatus = subData[0].stationStatus;
                    accumulatedChCap = subData[0].accumulatedChargeTime;
                    accumulatedDiCap = subData[0].accumulatedDischargeTime;
                    soc = subData[0].soc;
                    realTimeActivePower = subData[0].totW;
                    ableEnergyChCap = subData[0].ableCharCap;
                    todayChDiTimes = subData[0].dailyCgCnt;
                    monthChDiTimes = subData[0].monthlyCgCnt;
                    ableEnergyDiCap = subData[0].ableDiscCap;
                    accumulatedIncome = subData[0].accumulatedRev;
                    todayIncome = subData[0].todayRev;
                    lastDayIncome = subData[0].yesterdayRev;
                    comprehensiveEfficiency = subData[0].overallEfficiency;
                    runningFactor = subData[0].runningFactor;
                    utilizationRate = subData[0].utilRateInd;
                    lossRate = subData[0].storageScrapRate;
                    utilizationFactor = subData[0].utilFactor;
                    equivalentChDiTimes = subData[0].equivalentChargeDischargeTime;
                }

            })
            .finally(function () {
                renderSubData();
            })

        $("#logout").on('click', function (response) {
            axios.get('/sys/logout', {
                headers: {
                    'Authorization': `Bearer ${token}`
                }
            })
                .then(response => {
                    window.location.href = "/login.html";
                })
                .catch(error => {
                    console.error('Logout error:', error);
                });

        })

        dropdown.render({
            elem: '#change-sub',
            data: dropdownArr,
            click: function (obj) {
                this.elem.val(obj.title);
                this.elem.find('span').text(obj.title);

                runningDays = subData[obj.id].accumulatedRunningTime;
                todayChCap = subData[obj.id].charCapDay;
                todayDiCap = subData[obj.id].discCapDay;
                subStatus = subData[obj.id].stationStatus;
                accumulatedChCap = subData[obj.id].accumulatedChargeTime;
                accumulatedDiCap = subData[obj.id].accumulatedDischargeTime;
                soc = subData[obj.id].soc;
                realTimeActivePower = subData[obj.id].totW;
                ableEnergyChCap = subData[obj.id].ableCharCap;
                todayChDiTimes = subData[obj.id].dailyCgCnt;
                monthChDiTimes = subData[obj.id].monthlyCgCnt;
                ableEnergyDiCap = subData[obj.id].ableDiscCap;
                accumulatedIncome = subData[obj.id].accumulatedRev;
                todayIncome = subData[obj.id].todayRev;
                lastDayIncome = subData[obj.id].yesterdayRev;
                comprehensiveEfficiency = subData[obj.id].overallEfficiency;
                runningFactor = subData[obj.id].runningFactor;
                utilizationRate = subData[obj.id].utilRateInd;
                lossRate = subData[0].storageScrapRate;
                utilizationFactor = subData[0].utilFactor;
                equivalentChDiTimes = subData[0].equivalentChargeDischargeTime;
                renderSubData();
            }
        })

        function renderSubData() {
            $('#running-days').html("累计运行   " + '<span style="color: #a233c6; margin-left: 20px;">' + runningDays + '</span> <span>天</span>')
            // 今日充电量
            $("#todayChCap").html('<span class="sub-running-status-num">' + todayChCap + '</span> <span>MWh</span>');
            // 今日放电量
            $("#todayDiCap").html('<span class="sub-running-status-num">' + todayDiCap + '</span> <span>MWh</span>');
            // 电站状态
            $("#subStatus").html('<span style="color: green">' + subStatus + '</span>');
            // 累计充电量
            $("#accumulatedChCap").html('<span class="sub-running-status-num">' + accumulatedChCap + '</span> <span>MWh</span>');
            // 累计放电量
            $("#accumulatedDiCap").html('<span class="sub-running-status-num">' + accumulatedDiCap + '</span> <span>MWh</span>');
            $("#soc").html('<span class="sub-running-status-num">' + soc + '</span> <span>%</span>');
            // 实时有功
            $("#realTimeActivePower").html('<span class="sub-running-status-num">' + realTimeActivePower + '</span> <span>MWh</span>');
            // 实时无功
            $("#realTimeReactivePower").html('<span class="sub-running-status-num">' + realTimeReactivePower + '</span> <span>MWh</span>');
            // 可充电量
            $("#ableEnergyChCap").html('<span class="sub-running-status-num">' + ableEnergyChCap + '</span> <span>MWh</span>');
            // 今日充放电次数
            $("#todayChDiTimes").html('<span class="sub-running-status-num">' + todayChDiTimes + '</span>');
            // 本月充放电次数
            $("#monthChDiTimes").html('<span class="sub-running-status-num">' + monthChDiTimes + '</span>');
            // 可放电量
            $("#ableEnergyDiCap").html('<span class="sub-running-status-num">' + ableEnergyDiCap + '</span> <span>MWh</span>');
            $('#accumulated-income').html('<span style="font-weight: bold;">' + accumulatedIncome + '</span><span style="font-size: 16px !important;">万元</span>');
            $('#today-income').html('<span style="font-weight: bold;">' + todayIncome + '</span><span style="font-size: 16px !important;">万元</span>');
            $('#lastDay-income').html('<span style="font-weight: bold;">' + lastDayIncome + '</span><span style="font-size: 16px !important;">万元</span>');
            $('#comprehensiveEfficiency').text(comprehensiveEfficiency + '%');
            $('#runningFactor').text(runningFactor);
            $('#utilizationRate').text(utilizationRate + '%');
            $('#lossRate').text(lostRate + '%');
            $('#utilizationFactor').text(utilizationFactor);
            $('#equivalentChDiTimes').text(equivalentChDiTimes);
        }


        var dayAverage = 1111.11;
        $("#day-average").text(dayAverage);
        $("#this-month").text(dayAverage);
        $("#month-average").text(dayAverage);
        $("#this-year").text(dayAverage);
        $("#year-average").text(dayAverage);

        var xAxisData = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16',
            '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31'];
        var seriesData = [5, 20, 36, 10, 10, 20, 30, 40, 55, 70];

        $('#change-month-chart').on('click', function () {
            xAxisData = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16',
                '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31'];
            seriesData = [5, 20, 36, 10, 10, 20, 30, 40, 55, 70];
            incomeChart.setOption({
                xAxis: {
                    data: xAxisData
                },
                series: [{
                    data: seriesData
                }]
            })
            $('#change-month-chart').addClass('is-choose').removeClass('layui-border-blue');
            $('#change-year-chart').removeClass('is-choose').addClass('layui-border-blue');
        })

        $('#change-year-chart').on('click', function () {
            xAxisData = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];
            seriesData = [15, 22, 31, 21, 42, 20, 30, 40, 30, 70];
            incomeChart.setOption({
                xAxis: {
                    data: xAxisData
                },
                series: [{
                    data: seriesData
                }],
            })
            $('#change-year-chart').addClass('is-choose').removeClass('layui-border-blue');
            $('#change-month-chart').removeClass('is-choose').addClass('layui-border-blue');
        })


        var incomeChart = echarts.init(document.getElementById("income-chart"));
        var incomeChartOption = {
            tooltip: {},
            // legend: {
            //     data: ['销量']
            // },
            grid: {
                x: 45,
                y: 30,
                x2: 20,
                y2: 20
            },
            xAxis: {
                data: seriesData
            },
            yAxis: {
                type: 'value',
                name: "实时收益（元）",
                splitArea: {
                    show: true,
                    areaStyle: {
                        color: [
                            "#dfdfdf",
                            "white",
                            "#dfdfdf",
                            "white",
                            "#dfdfdf",
                            "white",
                        ]
                    }
                }
            },
            series: [
                {
                    name: '销量',
                    type: 'line',
                    data: seriesData,
                    itemStyle: {
                        normal: {
                            color: '#40c0ff'
                        }
                    },
                    areaStyle: {
                        color: "#d8e2f2"
                    }
                }
            ]
        }
        incomeChart.setOption(incomeChartOption);



        var bmsCounts = 0;
        var bmsAlarmCounts = 0;
        var pcsCounts = 0;
        var pcsAlarmCounts = 0;
        var airConditionCounts = 0;
        var airConditionAlarmCounts = 0;
        var fireControlCounts = 0;
        var fireControlAlarmCounts = 0;
        var bmsChart = echarts.init(document.getElementById('bms-status'));
        var pcsChart = echarts.init(document.getElementById('pcs-status'));
        var airConditionerChart = echarts.init(document.getElementById('air-conditioner-status'));
        var fireControlChart = echarts.init(document.getElementById('fire-control-status'));

        axios.get('/pcs/faultCounts', {
            headers: {
                'Authorization': `Bearer ${token}`
            }
        })
            .then(function (response) {
                console.log("pcs "+response)
                pcsCounts = response.data.totalCounts;
                pcsAlarmCounts = response.data.faultCounts;
            })

        axios.get('/fireControl/faultCounts', {
            headers: {
                'Authorization': `Bearer ${token}`
            }
        })
            .then(function (response) {
                console.log(response)

                fireControlCounts = response.data.totalCounts;
                fireControlAlarmCounts = response.data.faultCounts;
            })




        axios.get('/bms/faultCounts', {
            headers: {
                'Authorization': `Bearer ${token}`
            }
        })
            .then(function (response) {
                console.log(response)
                bmsCounts = response.data.totalCounts;
                bmsAlarmCounts = response.data.faultCounts;
                console.log(bmsCounts, bmsAlarmCounts)

                var bmsOption = {
                    tooltip: {},
                    backgroundColor: '#f6f8fb',
                    title: [{
                        text: 'BMS',
                        top: 'center',
                        left: 'center',
                        textStyle: {
                            color: '#000',
                            fontSize: 20
                        }
                    }],
                    series: [
                        {
                            type: "pie",
                            radius: ["50%", "70%"],
                            center: ["50%", "50%"],
                            avoidLabelOverlap: false,
                            hoverAnimation: true,
                            label: {
                                show: false,
                                position: 'center',
                            },
                            data: [
                                {
                                    name: '告警数量',
                                    value: bmsAlarmCounts,
                                    itemStyle: {color: "#4080ff"},
                                },
                                {
                                    name: '正常数量',
                                    value: bmsCounts - bmsAlarmCounts,
                                    itemStyle: {color: "#cccccc"}
                                }
                            ]
                        }
                    ]
                };
                var pcsOption = {
                    tooltip: {},
                    backgroundColor: '#f6f8fb',
                    title: [{
                        text: 'PCS',
                        top: 'center',
                        left: 'center',
                        textStyle: {
                            color: '#000',
                            fontSize: 20
                        }
                    }],
                    series: [
                        {
                            type: "pie",
                            radius: ["50%", "70%"],
                            center: ["50%", "50%"],
                            avoidLabelOverlap: false,
                            hoverAnimation: true,
                            label: {
                                show: false,
                                position: 'center',
                            },
                            data: [
                                {
                                    name: '告警数量',
                                    value: pcsAlarmCounts,
                                    itemStyle: {color: "#4080ff"},
                                },
                                {
                                    name: '正常数量',
                                    value: pcsCounts - pcsAlarmCounts,
                                    itemStyle: {color: "#cccccc"}
                                }
                            ]
                        }
                    ]
                };
                var airConditionerOption = {
                    tooltip: {},
                    backgroundColor: '#f6f8fb',
                    title: [{
                        text: '空调',
                        top: 'center',
                        left: 'center',
                        textStyle: {
                            color: '#000',
                            fontSize: 20
                        }
                    }],
                    series: [
                        {
                            type: "pie",
                            radius: ["50%", "70%"],
                            center: ["50%", "50%"],
                            avoidLabelOverlap: false,
                            hoverAnimation: true,
                            label: {
                                show: false,
                                position: 'center',
                            },
                            data: [
                                {
                                    name: '告警数量',
                                    value: airConditionAlarmCounts,
                                    itemStyle: {color: "#00c0a0"},
                                },
                                {
                                    name: '正常数量',
                                    value: airConditionCounts - airConditionAlarmCounts,
                                    itemStyle: {color: "#cccccc"}
                                }
                            ]
                        }
                    ]
                };
                var fireControlOption = {
                    tooltip: {},
                    backgroundColor: '#f6f8fb',
                    title: [{
                        text: '消防',
                        top: 'center',
                        left: 'center',
                        textStyle: {
                            color: '#000',
                            fontSize: 20
                        }
                    }],
                    series: [
                        {
                            type: "pie",
                            radius: ["50%", "70%"],
                            center: ["50%", "50%"],
                            avoidLabelOverlap: false,
                            hoverAnimation: true,
                            label: {
                                show: false,
                                position: 'center',
                            },
                            data: [
                                {
                                    name: '告警数量',
                                    value: fireControlAlarmCounts,
                                    itemStyle: {color: "#00c0a0"},
                                },
                                {
                                    name: '正常数量',
                                    value: fireControlCounts - fireControlAlarmCounts,
                                    itemStyle: {color: "#cccccc"}
                                }
                            ]
                        }
                    ]
                };

                bmsChart.setOption(bmsOption);
                pcsChart.setOption(pcsOption);
                airConditionerChart.setOption(airConditionerOption);
                fireControlChart.setOption(fireControlOption)

                $('#equipment-status .layui-col-md3:first-child .equipment-counts').html("设备总数: &nbsp; " + bmsCounts);
                $('#equipment-status .layui-col-md3:first-child .alarm-counts').html("告警数量: &nbsp;" + bmsAlarmCounts);
                $('#equipment-status .layui-col-md3:nth-child(2) .equipment-counts').html("设备总数: &nbsp;" + pcsCounts);
                $('#equipment-status .layui-col-md3:nth-child(2) .alarm-counts').html("告警数量: &nbsp;" + pcsAlarmCounts);
                $('#equipment-status .layui-col-md3:nth-child(3) .equipment-counts').html("设备总数: &nbsp;" + airConditionCounts);
                $('#equipment-status .layui-col-md3:nth-child(3) .alarm-counts').html("告警数量: &nbsp;" + airConditionAlarmCounts);
                $('#equipment-status .layui-col-md3:nth-child(4) .equipment-counts').html("设备总数: &nbsp;" + fireControlCounts);
                $('#equipment-status .layui-col-md3:nth-child(4) .alarm-counts').html("告警数量: &nbsp;" + fireControlAlarmCounts);

            })


        var realTimeChart = echarts.init(document.getElementById('real-time-data-chart'));
        var realTimeOption = {
            tooltip: {},
            legend: {
                data: ['有功功率', '无功功率'],
                right: 20
            },
            backgroundColor: '#ffffff',
            grid: {
                x: 45,
                y: 30,
                x2: 20,
                y2: 20
            },
            xAxis: {
                data: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
            },
            yAxis: {
                type: 'value',
                splitArea: {
                    show: true,
                    areaStyle: {
                        color: ['#dfdfdf', 'white', '#dfdfdf', 'white', '#dfdfdf', 'white']
                    }
                }
            },
            series: [
                {
                    name: '有功功率',
                    type: 'line',
                    data: seriesData,
                    itemStyle: {
                        color: '#568eff'
                    }
                },
                {
                    name: '无功功率',
                    type: 'line',
                    data: xAxisData,
                    itemStyle: {
                        color: '#ffc000'
                    }
                },
            ]
        };
        realTimeChart.setOption(realTimeOption);
    })

    function changeBg(element) {
        element.classList.remove('layui-btn-primary');
        element.classList.add('is-choose');
    }


</script>
</body>
<style>
    body {
        background-color: #f2f8ff;
    }

    .page-button {
        background-color: #e2e2e2;
        margin: 0 10px;
    }

    .part-title {
        color: rgba(0, 0, 0, .85);
        font-weight: bold;
        margin-bottom: 10px;
    }

    #current-day, #current-time {
        font-size: 16px;
        color: #666666;
    }

    #current-time {
        margin-top: 4px;
    }

    #sub-running-status {
        padding: 15px;
        border: solid transparent 1px;
        border-radius: 15px;
        background-color: #ffffff;
    }

    .sub-running-status-num {
        color: #1e9fff;
    }

    #sub-running-status .layui-col-md4 {
        display: flex;
        align-items: center;
        padding: 10px 25px;
        background-color: #f6f8fb;
    }

    #sub-running-status .layui-col-md6 div:first-child {
        margin-left: 5px;
    }

    .running-details {
        display: inline-block;
        margin-left: 5px;
        height: 40px;
        justify-content: center;
    }

    .running-details div {
        margin-left: 10px;
    }

    .layui-nav-item a {
        width: 60px;
        height: 30px;
        line-height: 30px;
        text-align: center;
        background-color: grey;
        margin: 10px 15px;
        border-radius: 25%;
        color: black;
    }

    #income {
        margin-top: 15px;
        border: solid 1px transparent;
        border-radius: 15px;
        background-color: #ffffff;
        padding: 10px 10px 300px 10px;
    }

    #income .income-type {
        color: #F2F2F2;
        display: inline-block;
        width: calc(32% - 5px);
        border: 1px solid transparent;
        border-radius: 10px;
    }

    .income-type div:first-child {
        font-size: 16px;
        margin-top: 2px;
        margin-left: 6px;
    }

    .income-type div:last-child {
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 30px;
        margin-top: 15px;
        margin-bottom: 15px;
    }

    #income .income-type:not(:last-of-type) {
        margin: 0 2% 5px 0;
    }

    #last-type {
        margin: 5px 0 !important;
    }

    .income-detail {
        display: inline-block;
        width: 20%;
        height: 80px;
    }

    .income-detail div {
        display: block;
        margin-top: 5px;
    }

    .income-detail div:first-child {
        margin-left: 10px;
    }

    .income-detail div:last-child {
        margin-top: 10px;
    }


    #day-average, #this-month, #month-average, #this-year, #year-average {
        margin-left: 30px;
        display: block;
        font-size: 24px;
        color: #4080ff;
    }

    #change-month-chart, #change-year-chart {
        margin-top: 10px;
        margin-bottom: 0 !important;
        border: 1px solid transparent;
        border-radius: 8px;
    }

    .is-choose {
        color: #F2F2F2 !important;
        background-color: #4080ff !important;
    }

    .is-choose:hover {
        color: #F2F2F2;
    }

    #evaluation-analysis {
        color: #F2F2F2;
        background-color: #ffffff;
        border: 1px solid transparent;
        border-radius: 15px;
        padding: 15px;
    }

    .evaluation-analysis-part {
        background-color: #73a8ff;
        padding: 3px;
        border: 3px solid transparent;
        border-radius: 6px;
    }

    .evaluation-analysis-data {
        text-align: center;
        margin: 22px 0;
        font-size: 20px;
    }

    #equipment-status {
        padding: 15px;
        margin-top: 15px;
        background-color: #ffffff;
        border: 1px solid transparent;
        border-radius: 15px;
    }

    #bms-status, #pcs-status, #air-conditioner-status, #fire-control-status {
        background-color: #e2e2e2;
        aspect-ratio: 1;
    }

    .equipment-counts, .alarm-counts {
        text-align: center;
        font-size: 18px;
        background-color: #f6f8fb;
    }

    .equipment-counts {
        padding: 6px;
        color: #333333;
    }

    .alarm-counts {
        padding-bottom: 10px;
        color: #a40d0d;
    }

    #real-time-data {
        margin-top: 15px;
        padding-top: 15px;
        background-color: #ffffff;
        border: 1px solid transparent;
        border-radius: 15px;
    }

    #real-time-data-chart {
        width: 100%;
        height: 250px;
    }

    #title {
        letter-spacing: 6px;
        text-align: right;
        vertical-align: center;
        font-size: 24px;
        font-weight: bold;
    }

</style>
</html>